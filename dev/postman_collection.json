{
    "info": {
        "_postman_id": "b1b1c5d2-0000-4000-8000-000000000000",
        "name": "Sistema Matrículas - Backend (local)",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
        "description": "Coleção com os principais endpoints para desenvolvimento front-end (SQLite local). Variáveis: baseUrl, accessToken, refreshToken"
    },
    "variable": [
        {
            "key": "baseUrl",
            "value": "http://localhost:3000",
            "type": "string"
        },
        {
            "key": "accessToken",
            "value": "",
            "type": "string"
        },
        {
            "key": "refreshToken",
            "value": "",
            "type": "string"
        }
    ],
    "item": [
        {
            "name": "Auth",
            "item": [
                {
                    "name": "Login",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"teste@mail.com\",\n  \"senha\": \"12345\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/auth/login",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "auth",
                                "login"
                            ]
                        }
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "const body = pm.response.json();",
                                    "if (body && body.accessToken) { pm.environment.set('accessToken', body.accessToken); }",
                                    "if (body && body.refreshToken) { pm.environment.set('refreshToken', body.refreshToken); }",
                                    "// opcional: também salva em collection (fallback)",
                                    "if (body && body.accessToken) { pm.collectionVariables.set('accessToken', body.accessToken); }",
                                    "if (body && body.refreshToken) { pm.collectionVariables.set('refreshToken', body.refreshToken); }"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ]
                },
                {
                    "name": "Refresh",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/auth/refresh",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "auth",
                                "refresh"
                            ]
                        }
                    },
                    "response": []
                },
                {
                    "name": "GET Professores (ADMIN)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/usuarios/professores",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "usuarios",
                                "professores"
                            ]
                        }
                    }
                },
                {
                    "name": "GET Professores com Turmas (ADMIN)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/usuarios/professores/turmas",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "usuarios",
                                "professores",
                                "turmas"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Public",
            "item": [
                {
                    "name": "GET Disciplinas",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/disciplinas",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "disciplinas"
                            ]
                        }
                    }
                },
                {
                    "name": "GET Horarios",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/horarios",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "horarios"
                            ]
                        }
                    }
                },
                {
                    "name": "WhoAmI",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/auth/whoami",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "auth",
                                "whoami"
                            ]
                        }
                    }
                },
                {
                    "name": "PUT Turma - Change Professor (ADMIN)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"professor_id\": 3\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/turmas/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "turmas",
                                ":id"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Disciplinas",
            "item": [
                {
                    "name": "POST Disciplina (ADMIN)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"codigo\": \"MAT202\",\n  \"nome\": \"Cálculo II\",\n  \"carga_horaria\": 60\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/disciplinas",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "disciplinas"
                            ]
                        }
                    }
                },
                {
                    "name": "PUT Disciplina (ADMIN)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"nome\": \"Cálculo II - Atualizada\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/disciplinas/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "disciplinas",
                                ":id"
                            ]
                        }
                    }
                },
                {
                    "name": "DELETE Disciplina (ADMIN)",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/disciplinas/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "disciplinas",
                                ":id"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Horarios",
            "item": [
                {
                    "name": "POST Horario (ADMIN)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"codigo\": \"M1\",\n  \"descricao\": \"Manhã 1\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/horarios",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "horarios"
                            ]
                        }
                    }
                },
                {
                    "name": "PUT Horario (ADMIN)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"descricao\": \"Manhã 1 - atualizada\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/horarios/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "horarios",
                                ":id"
                            ]
                        }
                    }
                },
                {
                    "name": "DELETE Horario (ADMIN)",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/horarios/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "horarios",
                                ":id"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Turmas",
            "item": [
                {
                    "name": "GET Turmas",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/turmas",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "turmas"
                            ]
                        }
                    }
                },
                {
                    "name": "POST Turma (ADMIN)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"codigo\": \"TURMA-EXEMPLO-1\",\n  \"nome\": \"Turma Exemplo 1\",\n  \"disciplina_id\": 1,\n  \"horario_id\": 1,\n  \"vagas\": 40\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/turmas",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "turmas"
                            ]
                        }
                    }
                },
                {
                    "name": "PUT Turma (ADMIN)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"vagas\": 30\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/turmas/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "turmas",
                                ":id"
                            ]
                        }
                    }
                },
                {
                    "name": "DELETE Turma (ADMIN)",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/turmas/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "turmas",
                                ":id"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Matriculas",
            "item": [
                {
                    "name": "POST Matricula (proteger)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"turmaId\": 1\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/matriculas",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "matriculas"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Usuarios",
            "item": [
                {
                    "name": "GET Usuarios (ADMIN)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/usuarios",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "usuarios"
                            ]
                        }
                    }
                },
                {
                    "name": "GET Usuario por id",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/usuarios/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "usuarios",
                                ":id"
                            ]
                        }
                    }
                },
                {
                    "name": "GET Turmas do Professor (ADMIN or owner)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/usuarios/:id/turmas",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "usuarios",
                                ":id",
                                "turmas"
                            ]
                        }
                    }
                },
                {
                    "name": "POST Usuario (ADMIN)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"nome\": \"Novo Usuário\",\n  \"email\": \"novo.user@mail.com\",\n  \"senha\": \"senha123\",\n  \"roles\": [\"ALUNO\"]\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/usuarios/register",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "usuarios"
                            ]
                        }
                    }
                },
                {
                    "name": "PUT Usuario (ADMIN or self)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"nome\": \"Nome Atualizado\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/usuarios/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "usuarios",
                                ":id"
                            ]
                        }
                    }
                },
                {
                    "name": "DELETE Usuario (ADMIN)",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/usuarios/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "usuarios",
                                ":id"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Matriculas (full)",
            "item": [
                {
                    "name": "GET Matriculas (me or all)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/matriculas",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "matriculas"
                            ]
                        }
                    }
                },
                {
                    "name": "GET Matricula por id",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/matriculas/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "matriculas",
                                ":id"
                            ]
                        }
                    }
                },
                {
                    "name": "PUT Matricula (status/atualizar)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"status\": \"CANCELLED\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/matriculas/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "matriculas",
                                ":id"
                            ]
                        }
                    }
                },
                {
                    "name": "DELETE Matricula (owner or ADMIN)",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{accessToken}}"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/matriculas/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "matriculas",
                                ":id"
                            ]
                        }
                    }
                }
            ]
        }
    ]
}